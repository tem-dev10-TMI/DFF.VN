function Page() { } function getQueryString(t) { var e = new URLSearchParams(window.location.search); return e.has(t) ? e.get(t) : null } function isNull(t) { return null == t || void 0 === t || "null" == t || "undefined" == t || "" == $.trim(t) } function isRealValue(t) { return t && "null" !== t && "undefined" !== t } function formatNumber(t) { return isRealValue(t) ? t.toLocaleString(void 0, { minimumFractionDigits: 2, maximumFractionDigits: 2 }) : "" } function bindLike(t, e) { $(t).on("click", ".com-like span", (function (t) { var a = $(this).find("svg"); if (!isDoubleClicked($(this)) && Page.scan()) { var n = a.parent().parent(), i = n.find(".value"), o = parseInt(i.attr("data-old")), r = i.text(), s = a.data("type"), l = a.data("voted"), c = n.attr("data-id"); "up" === s ? l ? (r--, a.data("voted", !1).attr("class", "")) : (r++, a.data("voted", !0).attr("class", "active"), n.find(".for-down svg").data("voted") && (r++, n.find(".for-down svg").data("voted", !1).attr("class", ""))) : "down" === s && (l ? (r++, a.data("voted", !1).attr("class", "")) : (r--, a.data("voted", !0).attr("class", "active"), n.find(".for-up svg").data("voted") && (r--, n.find(".for-up svg").data("voted", !1).attr("class", "")))), i.text(r), interact(c, e, r - o) } })) } !function (t) { t.extend({ lockfixed: function (e, a) { if (a && a.offset ? (a.offset.bottom = parseInt(a.offset.bottom, 10), a.offset.top = parseInt(a.offset.top, 10)) : a.offset = { bottom: 100, top: 0 }, (e = t(e)) && e.offset()) { var n = e.offset().top; e.offset(), e.outerHeight(!0); var i = e.outerWidth(), o = e.css("position"), r = e.css("top"), s = parseInt(e.css("marginTop"), 10), l = t(document).height() - a.offset.bottom, c = 0, u = !1; (!0 === a.forcemargin || navigator.userAgent.match(/\bMSIE (4|5|6)\./) || navigator.userAgent.match(/\bOS (3|4|5|6)_/) || navigator.userAgent.match(/\bAndroid (1|2|3|4)\./i)) && (u = !0), t(window).bind("scroll resize orientationchange load", e, (function () { var d = e.outerHeight(), p = t(window).scrollTop(); u && document.activeElement && "INPUT" === document.activeElement.nodeName || (p >= n - (s || 0) - a.offset.top ? (c = l < p + d + s + a.offset.top ? p + d + s + a.offset.top - l : 0, u ? e.css({ marginTop: parseInt((s || 0) + (p - n - c) + 2 * a.offset.top, 10) + "px" }) : e.css({ position: "fixed", top: a.offset.top - c + "px", width: i + "px" })) : e.css({ position: o, top: r, width: i + "px", marginTop: (s || 0) + "px" })) })) } } }) }(jQuery), Page.urlBase = "https://dff.vn/vendor/dffvn/news/Handler/", Page.registerModule = function (t) { var e = this; Page.init(), t.querySelectorAll("[module-load]").forEach((function (t) { $(t).off("click"); var a = t.getAttribute("module-load"); null != (a = e[a]) && a.bind(e)(t) })) }, Page.init = function () { var t = getQueryString("q"); -1 != window.location.href.indexOf("tim-kiem") && $(".box-search input").val(t), $("#back-top,.top-home").click((function () { $("html, body").animate({ scrollTop: 0 }, 1e3) })), $(".m-search").click((function () { var t = $(".header-logo .box-search"); t.is(":visible") ? t.hide("slow") : t.show("slow") })), $(".autoresizing").on("input", (function () { this.style.height = "auto", this.style.height = this.scrollHeight + "px" })), showtime(), OnStatus(), bindAlert(), isRealValue(getQueryString("ref")) && Page.register(), isRealValue(getQueryString("tk")) && Page.recover() }, Page.info = function (t) { $(t).click((function () { var t = Page.urlBase + "loadmodule.ashx"; $.ajax({ type: "POST", url: t, data: { t: 12 }, success: function (t) { isRealValue(popup) && popup.hide(), (popup = new Popup(900)).title = "Thông tin tài khoản ", popup.content = t, popup.show() } }) })) }, Page.logout = function (t) { $(t).click((function () { var t = Page.urlBase + "action.ashx"; $.ajax({ type: "POST", url: t, data: { t: 1 }, success: function (t) { window.location = "/" } }) })) }, Page.bindsoc = function () { $(".sharefb").click((function () { var t = window.location.hostname + $(this).attr("data-url"); fbClient.shareClick(t) })), $(".copylink").click((function () { var t = window.location.hostname + $(this).attr("data-url"); navigator.clipboard.writeText(t) })), bindLike(".view-card .item-bottom,.view-cardd .item-bottom,.view-carde .item-bottom,.detail .item-bottom", 1) }, Page.redirect = function (t) { $(t).click((function () { if (can) { var e = $(t).attr("data-url"); window.location = e } else Page.login() })) }, Page.csend = function (t) { $(t).click((function () { if (Page.scan()) { var e = $(t).parent().find("textarea"), a = e.val(); commentadd($("#hdd_id").val(), 0, a), e.val("") } })) }, Page.follow = function (t) { $(t).click((function () { if (Page.scan()) { var t = $(this).attr("class"); console.log(t); var e = 0; "active" == t ? ($(this).attr("class", ""), e = 0, $(this).find("val").text("Theo dõi ")) : ($(this).attr("class", "active"), $(this).find("val").text("Đang theo dõi "), e = 1), interact($(this).attr("data-ref"), $(this).attr("data-type"), e) } })) }, Page.savenews = function (t) { $(t).click((function () { Page.scan() && ("far fa-bookmark" == $(this).attr("class") ? ($(this).attr("class", "far fa-bookmark active"), value = 1) : ($(this).attr("class", "far fa-bookmark"), value = 0), interact($("#hdd_id").val(), 4, value)) })) }; var popup, ctype = 0; function commentadd(t, e, a) { var n = { content: a, nid: t, pid: e, ctype: ctype }, i = Page.urlBase + "article.ashx?t=10"; $.ajax({ type: "POST", url: i, data: n, success: function (t) { (t.code = 200) && Page.Notify(t.notify) } }) } function sleep(t) { return new Promise((e => setTimeout(e, t))) } Page.home = function (t) { }, Page.scan = function () { return can || Page.login(), can }, Page.Notify = function (t) { swal("", t) }, Page.Notify2 = function (t) { $.notify({ title: "", message: t }, { type: "primary", allow_dismiss: !0, delay: 3e3, placement: { from: "top", align: "center" } }) }, Page.Alert = function (t, e) { swal({ title: t, confirmButtonText: "OK" }).then((t => { t.value && null != e && null != e && "function" == typeof e && e() })) }, Page.Confirm = function (t, e) { swal({ title: "Are you sure?", showCancelButton: !0, confirmButtonColor: "#3085d6", cancelButtonColor: "#d33", confirmButtonText: "Đồng ý", cancelButtonText: "Thoát!" }).then((function (t) { t.value && null != e && null != e && "function" == typeof e && e() })).catch((function (t) { })) }, Page.signin = function (t) { $(t).click((function () { Page.scan() && (window.location = "/info.html") })) }, Page.login = function () { var t = Page.urlBase + "loadview.ashx?t=1"; $.ajax({ type: "POST", url: t, success: function (t) { isRealValue(popup) && popup.hide(), (popup = new Popup(450)).title = "Đăng nhập ", popup.content = t, popup.show() } }) }, Page.changepass = function (t) { $(t).click((function () { var t = Page.urlBase + "loadview.ashx?t=22"; $.ajax({ type: "POST", url: t, success: function (t) { isRealValue(popup) && popup.hide(), (popup = new Popup(450)).title = "Đổi mật khẩu ", popup.content = t, popup.show() } }) })) }, Page.qeditor = function (t) { $(t).click((function () { if (Page.scan()) { var t = Page.urlBase + "loadview.ashx?t=23"; $.ajax({ type: "POST", url: t, success: function (t) { isRealValue(popup) && popup.hide(), (popup = new Popup(500)).title = "Tạo bài viết", popup.content = t, popup.show(), $(".mn-submit").on("click", (function () { mnSend() })), $("#mnAvatar").on("change", (function () { mnAvatar(this) })), mnValidate() } }) } })) }, Page.loadwrite = function (t) { $(t).click((function () { callwrite(t) })) }; var iswrite = !0; function callwrite(t) { if (Page.scan() && iswrite) { var e = Page.urlBase + "loadview.ashx?t=38"; $.ajax({ type: "POST", url: e, data: { id: 0 }, success: function (t) { if (200 == t.code) { isRealValue(popup) && popup.hide(), (popup = new Popup(700)).showCancel = !1, popup.title = "Tạo bài viết", popup.content = t.content, popup.show(), $("#mnAvatar").on("change", (function () { mnAvatar(this) })); const a = document.getElementsByClassName("btnEditSave"); for (var e = 0; e < a.length; e++)a[e].addEventListener("click", (t => { var e = t.target.getAttribute("ref"); cEditor.fillData(1, e) })); $(".editor .bg-options span").click((function () { var t = $(this).attr("class"); $(".editor > div").attr("class", t), "mncolor0" == t ? ($(".mnImg,#bodyjs,#Title,.mnImg,.mfsend").show(), $("#qTitle,.mqsend").hide(), $("#mnAvatar").prop("disabled", !1), $(".editor .bi-camera-fill").attr("style", "opacity: 1;")) : ($(".mnImg,#bodyjs,#Title,.mnImg,.mfsend").hide(), $("#qTitle,.mqsend").show(), $("#mnAvatar").prop("disabled", !0), $(".editor .bi-camera-fill").attr("style", "opacity: 0.1;")) })), $(".mqsend").on("click", (function () { mqSend(this) })), initBlock([]) } else 511 == t.code && formsms() } }) } } function bindprofileadd() { $("#formProfileAdd").validate({ rules: { fullName: { required: !0, normalizer: function (t) { return $.trim(t) } }, userName: { required: !0, normalizer: function (t) { var e = t.replace(/[^a-zA-Z0-9-]/g, ""); return e != t && $("#userName").val(e), e } } }, messages: { fullName: { required: "Bạn chưa nhập tên hiển thị" }, userName: { required: "Bạn chưa nhập Profile" } } }) } function aswitch() { $(".aswitch").each((function () { $(this).click((function () { var t = { q: $(this).attr("ref"), t: 22 }; $.ajax({ type: "POST", url: Page.urlBase + "action.ashx", data: t, success: function (t) { if (200 == t.code) { var e = window.location.href; -1 != e.indexOf("/write.html") && (e = "/write.html"), window.location = e } else Page.Notify(t.notify) } }) })) })) } function sendsms() { var t = $("#phone_error"), e = ($("step-container"), $("#phone").val().trim()); if ("" != e && isPhone(e)) { t.hide(); var a = Page.urlBase + "article.ashx", n = { t: 15, phone: e }; $.ajax({ type: "POST", url: a, data: n, success: function (t) { 200 == t.code && ($("#bt_confirm").tab("show"), $("#smsalert").show(), $("#smsphone").text("*******" + e.substring(6))), Page.Notify2(t.notify) } }) } else t.show() } function confirmsms() { var t = $("#sms_error"); let e = ""; if (document.querySelectorAll("#otp > input").forEach((t => e += t.value)), 6 == e.length) { t.hide(); var a = Page.urlBase + "article.ashx", n = { t: 16, sms: e }; $.ajax({ type: "POST", url: a, data: n, success: function (t) { t.code, Page.Notify2(t.notify) } }) } else t.show() } function formsms() { var t = Page.urlBase + "LoadModule.ashx"; $.ajax({ type: "POST", url: t, data: { t: 20 }, success: function (t) { isRealValue(popup) && popup.hide(), (popup = new Popup(450)).showCancel = !1, popup.title = "Xác thực tài khoản ", popup.content = t, popup.close = function () { window.location = "/" }, popup.show() } }) } Page.createprofile = function (t) { $(t).click((function () { if (Page.scan()) { var t = Page.urlBase + "loadview.ashx?t=39"; $.ajax({ type: "POST", url: t, success: function (t) { isRealValue(popup) && popup.hide(), (popup = new Popup(600)).showCancel = !1, popup.title = "Thêm mới profile", popup.content = t, popup.show(); var e = "#formProfileAdd"; $(e).submit((function (t) { if (t.preventDefault(), $(e).valid()) { var a = $(e).serialize(), n = Page.urlBase + "Action.ashx"; $.ajax({ type: "POST", url: n, data: a, success: function (t) { Page.Notify(t.notify), 200 == t.code && (window.location = "/pages.html") } }) } })), bindprofileadd() } }) } })) }, Page.report = function (t) { $(t).click((function () { var t = Page.urlBase + "loadview.ashx?t=21"; $.ajax({ type: "POST", url: t, success: function (t) { isRealValue(popup) && popup.hide(), (popup = new Popup(450)).title = "Báo cáo bài đăng vi phạm ", popup.content = t, popup.show() } }) })) }, Page.register = function (t) { var e = getQueryString("ref"), a = Page.urlBase + "loadview.ashx?t=2&ref=" + e; $.ajax({ type: "POST", url: a, success: function (t) { isRealValue(popup) && popup.hide(), (popup = new Popup(450)).title = "Đăng ký tài khoản ", popup.content = t, popup.show() } }) }, Page.forgot = function (t) { var e = Page.urlBase + "loadview.ashx?t=32"; $.ajax({ type: "POST", url: e, success: function (t) { isRealValue(popup) && popup.hide(), (popup = new Popup(450)).title = "Lấy lại mật khẩu ", popup.content = t, popup.show() } }) }, Page.recover = function (t) { var e = Page.urlBase + "loadview.ashx?t=33&tk=" + getQueryString("tk"); $.ajax({ type: "POST", url: e, success: function (t) { isRealValue(popup) && popup.hide(), (popup = new Popup(450)).title = "Đặt mật khẩu mới ", popup.content = t, popup.show() } }) }, Page.onGoogle = function () { window.name = "parent"; var t = screen.width / 2 - 350, e = screen.height / 2 - 225; window.open("https://accounts.google.com/o/oauth2/v2/auth?access_type=online&client_id=832327447481-bcqdqp4b6mfvstmstq407jcal5d242un.apps.googleusercontent.com&redirect_uri=https://dff.vn/vendor/dffvn/news/Handler/Google.ashx?t=17&response_type=code&scope=email&prompt=consent", "Google Account", "toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=700, height=485, top=" + e + ", left=" + t) }, Page.onSearch = function (t) { return $(t).click((function () { var t = $(".box-search input").val(); if ("" != (t = encodeURIComponent(t))) { var e = "/tim-kiem.html?q=" + t; document.all ? window.location.href = e : document.location.href = e } else $(".box-search input").focus() })), !1 }, Page.onEvent = function (t) { return $(t).click((function () { "" != (key = (key = $("#txtEvent").val()).trim()) && ($(".cover-page").html(""), Page.loadData()) })), !1 }; var type = 0, loaded = !1, end = !1, key = ""; ctype = 1; function OnEnter(t) { if (!t) t = window.event; return !t || 13 != t.keyCode || (t.cancelBubble = !0, t.returnValue = !1, t.cancel = !0, $(".btn-seach").click(), !1) } function OnStatus() { can = !1, $.ajax({ url: Page.urlBase + "loadview.ashx?t=16", method: "POST", data: {}, success: function (t) { 200 == t.code && (can = !0, code = t.data.Code, $(".signin").hide(), $(".signed").attr("style", "display: block;"), isRealValue(t.data.Avatar) && $(".signed >a,.img-own").html(t.data.Avatar), isRealValue(t.data.Banner) && $(".banner-own").attr("style", 'background: url("' + t.data.Banner + '")'), $(".profiles ul").html(t.content), t.data.AllowSupportAI && $(".menu-ai").show(), aswitch()) } }) } function OnSocial(t, e) { var a = $(".label_fl"); $.ajax({ url: Page.urlBase + "loadview.ashx?t=28", method: "POST", data: { id: t, otype: e }, success: function (t) { a.text(t.data) } }) } function mnSend() { if ($("#formQEdit").valid()) { var t = Page.urlBase + "Article.ashx?t=11", e = $("#mnAvatar")[0].files[0], a = new FileReader; if (null != e) a.readAsDataURL(e), a.onloadend = function () { var n = { title: $("#mnTitle").val(), css: "", fileAsBase64: a.result, fileName: e.name }; $.ajax({ type: "POST", url: t, data: n, success: function (t) { 200 == t.code && isRealValue(popup) && popup.hide(), Page.Notify(t.notify) } }) }; else { var n = $(".mn-editor > div").attr("class"), i = $(".mnshareinfo span").attr("ref"), o = $(".mnImg img").attr("src"), r = $(".mnshareinfo span").text(), s = $(".mnshareinfo h5").text(), l = { title: $("#mnTitle").val(), css: n, url: i, img: o, domain: r, subtitle: s }; $.ajax({ type: "POST", url: t, data: l, success: function (t) { 200 == t.code && isRealValue(popup) && popup.hide(), Page.Notify(t.notify) } }) } } } function mqSend() { var t = Page.urlBase + "Article.ashx?t=11", e = $(".editor > div").attr("class"), a = $(".editor .mnImg img").attr("src"), n = $("#qTitle").val(); if (n.length < 10) return Page.Notify2("Chủ đề không thể dưới 10 ký tự!"), !1; var i = { title: n, css: e, url: "", img: a, domain: "", subtitle: "" }; $.ajax({ type: "POST", url: t, data: i, success: function (t) { 200 == t.code && isRealValue(popup) && popup.hide(), Page.Notify(t.notify) } }) } function mnAvatar(t) { var e = $(t).val(), a = $(t).attr("ref"); console.log(a); var n = e.substring(e.lastIndexOf(".") + 1).toLowerCase(); if (t.files && t.files[0] && ("gif" == n || "png" == n || "jpeg" == n || "jpg" == n)) { var i = new FileReader; i.onload = function (t) { 1 == a ? $(".mnImg").html('<img src="' + t.target.result + '">') : ("mncolor0" != $(".mn-editor > div").attr("class") && $(".mn-editor > div").attr("class", "mncolor0"), $(".mnImg").html('<img src="' + t.target.result + '">'), $(".mnshareinfo").html("")) }, i.readAsDataURL(t.files[0]) } } function mnValidate() { $("#formQEdit").validate({ rules: { mnTitle: { required: !0 } }, messages: { mnTitle: { required: "Bạn chưa nhập tiêu đề" } } }) } function bindAlert() { can = !1, $.ajax({ url: Page.urlBase + "loadview.ashx?t=17", method: "POST", data: {}, success: function (t) { $("#pills-tabContent").append(t) } }) } Page.loadData = function (t) { if (0 != type && !loaded && !end) { loaded = !0; var e = $(".cover-page"); isRealValue(key) || (key = getQueryString("q")); var a = $(".cover-page .cover-page-i").last().attr("data-id"), n = $("#topicid").val(), i = $("#toptype").val(); $.ajax({ url: Page.urlBase + "loadview.ashx?t=" + type, method: "POST", data: { id: a, key: key, tid: n, ttype: i }, beforeSend: function () { }, success: function (t) { isRealValue(t) && t.length > 0 ? (e.append(t), loaded = !1, Page.bindsoc()) : end = !0 } }) } }, Page.actmn = function (t) { var e = $(t).data("ref"); $(".left-menu .mnavi li").each((function () { $(this).attr("class", "item") })), $(".left-menu .mnavi").find("[data-ref=" + e + "]").attr("class", "item active") }, Page.boxIndex = function (t) { bindIndex() }; var irequest = !1; function bindIndex() { irequest || (irequest = !0, $.ajax({ url: Page.urlBase + "loadbox.ashx?t=1", method: "POST", data: {}, beforeSend: function () { }, success: function (t) { try { $.each(t.data.Data, (function (t, e) { var a = $(".co-" + e.code); a.find(".value").text(formatNumber(e.price)); var n = "bi bi-dash", i = "nochange"; e.change > 0 ? (n = "bi bi-caret-up-fill", i = "up") : e.change < 0 && (n = "bi bi-caret-down-fill", i = "down"), a.find(".content i").attr("class", n), a.find(".content .per").text(parseFloat(e.changePct.toFixed(2)) + "%"), a.find(".content index").text(parseFloat(e.change.toFixed(2))), a.find(".content").attr("class", "irow content " + i) })) } catch { } irequest = !1 } })) } function showtime() { var t, e = new Date(Date.now()); t = ["Chủ Nhật", "Thứ hai", "Thứ ba", "Thứ tư", "Thứ năm", "Thứ sáu", "Thứ bảy"][e.getDay()] + ", " + handleSingleDigit(e.getDate()) + "/" + handleSingleDigit(e.getMonth() + 1) + "/" + e.getFullYear() + " ", $(".currentDate").text(t) } function handleSingleDigit(t) { return 1 === t.toString().length ? "0" + t : t } function bindLogin() { $("#login").validate({ rules: { userName: { required: !0, maxlength: 50 }, password: { required: !0, minlength: 3 } }, messages: { userName: { required: "Vui lòng nhập tài khoản" }, password: { required: "Vui lòng nhập mật khẩu" } } }), $(".login-with-google-btn").click((function () { Page.onGoogle() })) } function bindChangePassword() { $("#changepass").validate({ rules: { passwordold: { required: !0, minlength: 6 }, password: { required: !0, minlength: 6 }, passwordconfirm: { equalTo: "#password" } }, messages: { passwordold: { required: "Bạn chưa nhập mật khẩu cũ" }, password: { required: "Bạn chưa nhập mật khẩu", minlength: "Nhập ít nhất 6 ký tự", maxlength: "Nhập tối đa 200 ký tự" }, passwordconfirm: { equalTo: "Mật khẩu xác nhận chưa đúng" } } }) } function isPhone(t) { return /(((\+|)84)|0)(3|5|7|8|9)+([0-9]{8})\b/.test(t) } function bindRegister() { $.validator.addMethod("phone", (function (t, e) { return isPhone(t) }), "Số điện thoại không đúng!"), $("#register").validate({ rules: { fullName: { required: !0, normalizer: function (t) { return $.trim(t) } }, password: { required: !0, minlength: 3, maxlength: 200 }, email: { required: !0, email: !0 }, userName: { required: !0, normalizer: function (t) { var e = t.replace(/[^a-zA-Z0-9-]/g, ""); return e != t && $("#userName").val(e), e } } }, messages: { fullName: { required: "Bạn chưa nhập họ tên" }, password: { required: "Bạn chưa nhập mật khẩu", minlength: "Nhập ít nhất 3 ký tự", maxlength: "Nhập tối đa 200 ký tự" }, email: { required: "Bạn chưa nhập Email", email: "Email chưa đúng định dạng" }, userName: { required: "Bạn chưa nhập tên đăng nhập" } } }) } function isAlphaOrParen(t) { return /^[a-zA-Z0-9()]+$/.test(t) } function interact(t, e, a) { var n = Page.urlBase + "Action.ashx", i = { id: t, t: 14, type: e, content: a }; $.ajax({ type: "POST", url: n, data: i, success: function (t) { } }) } function isDoubleClicked(t) { return !!t.data("isclicked") || (t.data("isclicked", !0), setTimeout((function () { t.removeData("isclicked") }), 1e3), !1) } function send_report() { var t = ""; if ($(".c-reports ul li").each((function (e) { var a = $(this), n = a.attr("data-ref"); "selected" == a.attr("class") && (t += n + ",") })), "" != t) { var e = { content: $(".c-reports textarea").val(), result: t }, a = Page.urlBase + "article.ashx?t=11"; isRealValue(popup) && popup.hide(), $.ajax({ type: "POST", url: a, data: e, success: function (t) { Page.Notify("Báo cáo đã được gửi!") } }) } else Page.Notify("Chưa có thông tin vi phạm?") } function cancel_reply() { $(".reply_comment").remove() } function getShare(t) { var e = (t.clipboardData || window.clipboardData).getData("Text"); if ("mncolor0" == $(".mn-editor > div").attr("class") && isValidUrl(e)) { var a = { url: e }, n = Page.urlBase + "loadview.ashx?t=24"; $.ajax({ type: "POST", url: n, data: a, success: function (t) { if (200 == t.code) { var a = t.data; $(".mnImg").html('<img src="' + a.Avatar + '">'), $(".mnshareinfo").html('<div><span ref="' + e + '">' + a.Domain + "</span><h5>" + a.Title + "</h5></div>") } } }) } } Page.flSuggest = function () { $.ajax({ url: Page.urlBase + "loadview.ashx?t=27", method: "POST", data: {}, beforeSend: function () { }, success: function (t) { $(".box-follow").append(t), Page.registerModule(document) } }) }, Page.loadNs = function (t) { var e = $("#hdd_id").val(), a = Page.urlBase + "LoadView.ashx?t=9", n = { nid: e }; $.ajax({ type: "POST", url: a, data: n, success: function (t) { if (200 == t.code) { var e = $(".box-n-sc .com-like .value"); e.attr("data-old", t.data.TotalLike), e.text(t.data.TotalLike), t.data.TotalComment > 0 ? Page.loadCm(0, $(".list_comment"), 0, 0, 0) : $(".comment-cover").hide(), $(".img-news").html(t.data.CustomerAvatar), $(".total-fol").text(t.data.TotalFollow), 1 == t.data.ObjectValue ? $(".box-n-sc .for-up svg").attr("class", "active") : -1 == t.data.ObjectValue && $(".box-n-sc .for-down svg").attr("class", "active"); var a = $(".bn-fol1").find("i"); 1 == t.data.Followed ? a.attr("class", "bi bi-check") : a.attr("class", "bi bi-plus"), 1 == t.data.Saved && $(".detail .fc-saved i").attr("class", "far fa-bookmark active") } } }) }, Page.loadCm = function (t, e, a, n, i) { n <= 0 && (n = $("#hdd_id").val()), $.ajax({ url: Page.urlBase + "loadview.ashx?t=8", method: "POST", data: { nid: n, pid: t, id: a, ctype: i }, beforeSend: function () { }, success: function (t) { isRealValue(t) && t.length > 0 && ($(".item-default").remove(), e.append(t), $(".list_comment").on("click", ".cm-childs", (function (t) { if (!isDoubleClicked($(this))) { var e = $(this).attr("data-id"), a = $(this).parent().parent(), o = a.find("li:last").attr("data-ref"); Page.loadCm(e, a, o, n, i) } })), $(".list_comment").on("click", ".replay", (function (t) { if (Page.scan() && !isDoubleClicked($(this))) { cancel_reply(); var e = $(this).parent().parent().parent(), a = e.attr("data-id"), n = document.createElement("div"); n.className = "box_reply row", n.innerHTML = '<div class="col-md-12 reply_comment"><div class="row"><div class="box_comment col-md-12"><textarea class="comment_replay autoresizing" placeholder="Viết bình luận" data-id="' + a + '"></textarea><div class="box_post"><div class="pull-right"><button class="cancel" onclick="cancel_reply()" type="button">Hủy</button><button onclick="submit_reply()" type="button" value="1">Gửi</button></div></div></div></div></div>', e.append(n), $(".autoresizing").on("input", (function () { this.style.height = "auto", this.style.height = this.scrollHeight + "px" })) } })), bindLike(".item-bottom", 2)) } }) }; const isValidUrl = t => { let e; try { e = new URL(t) } catch (t) { return !1 } return "http:" === e.protocol || "https:" === e.protocol }; function submit_reply() { if (Page.scan()) { var t = $(".comment_replay"), e = t.attr("data-id"); commentadd($("#hdd_id").val(), e, t.val()), cancel_reply() } } function bindInfo() { var t = "#formData"; $(t).validate({ rules: { FullName: { required: !0 } }, messages: { FullName: { required: "Bạn chưa nhập họ và tên " } } }), $("#ImageAvatar").click((function () { fileManager("#Avatar", "#ImageAvatar", "callback") })), $(t).submit((function (e) { if (e.preventDefault(), $(t).valid()) { var a = $(t).serialize(), n = Page.urlBase + "action.ashx"; $.ajax({ type: "POST", url: n, data: a, success: function (t) { isRealValue(popup) && popup.hide(), Page.Notify(t.notify) } }) } })), $(".copylink").click((function () { var t = window.location.hostname + $(this).attr("data-url"); navigator.clipboard.writeText(t) })) } function bindForgot() { $.validator.addMethod("isEmail", (function (t, e) { return /^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(t) })); var t = "#formData"; $(t).validate({ rules: { Email: { isEmail: !0 } }, messages: { Email: { isEmail: "Email không hợp lệ" } } }), $(t).submit((function (e) { if (e.preventDefault(), $(t).valid()) { var a = $(t).serialize(), n = Page.urlBase + "google.ashx"; $.ajax({ type: "POST", url: n, data: a, success: function (t) { Page.Notify(t.notify) } }) } })) } function bindRecover() { var t = "#formData"; $(t).validate({ rules: { Password: { required: !0, minlength: 6, maxlength: 15 } }, messages: { Password: { required: "Hãy nhập mật khẩu", minlength: "Mật khẩu ít nhất 6 ký tự và nhỏ hơn 15 ký tự", maxlength: "Mật khẩu ít nhất 6 ký tự và nhỏ hơn 15 ký tự" } } }), $(".toggle-password").click((function () { $(this).toggleClass("fa-eye fa-eye-slash"); var t = $($(this).attr("toggle")); "password" == t.attr("type") ? t.attr("type", "text") : t.attr("type", "password") })), $(t).submit((function (e) { if (e.preventDefault(), $(t).valid()) { var a = $(t).serialize(), n = Page.urlBase + "google.ashx"; $.ajax({ type: "POST", url: n, data: a, success: function (t) { isRealValue(popup) && popup.hide(), Page.Notify(t.notify), window.location = "/" } }) } })) } function bindStock1() { jQuery(".box-company").owlCarousel({ autoplay: !1, rewind: !1, margin: 10, dots: !1, responsiveClass: !0, autoHeight: !0, autoplayTimeout: 7e3, smartSpeed: 800, nav: !0, navText: ["<i class='fa fa-chevron-left'></i>", "<i class='fa fa-chevron-right'></i>"], responsive: { 0: { items: 2, rows: 3 }, 600: { items: 2 }, 1024: { items: 3 }, 1366: { items: 3 } } }), $(".box-company li.f-folw a").each((function (t) { Page.follow(this) })) } function bindreport() { $(".c-reports ul li").each((function (t) { var e = $(this), a = e.attr("data-ref"); e.on("click", (function () { "selected" == e.attr("class") ? e.attr("class", "") : (e.attr("class", "selected"), 1 == a ? (clear_report(), $(".c-reports textarea").show()) : ($('.c-reports ul li[data-ref="1"]').attr("class", ""), $(".c-reports textarea").hide())) })) })), $(".c-reports .send").on("click", (function () { send_report() })) } function bindStock2() { jQuery(".box-company2").owlCarousel({ autoplay: !0, rewind: !1, margin: 10, dots: !1, responsiveClass: !0, autoHeight: !0, autoplayTimeout: 7e3, smartSpeed: 800, nav: !0, navText: ["<i class='fa fa-chevron-left'></i>", "<i class='fa fa-chevron-right'></i>"], responsive: { 0: { items: 1 }, 600: { items: 1 }, 1024: { items: 2 }, 1366: { items: 2 } } }), $(".box-company2 li.row2 a").each((function (t) { Page.follow(this) })) } function clear_report() { $(".c-reports ul li").each((function (t) { var e = $(this); 1 != e.attr("data-ref") && e.attr("class", "") })) } var q_title, q_url; function active(t, e) { Page.Alert(t), setTimeout((function () { window.location = "/" }), 2e3) } loadDetail = function (t) { var e = { nid: $(t).data("ref") }, a = Page.urlBase + "loadview.ashx?t=30"; $.ajax({ type: "POST", url: a, data: e, success: function (e) { isRealValue(popup) && popup.hide(); var a = $(t).attr("title"), n = $(t).data("href"); isRealValue(q_url) || (q_title = a, q_url = n), document.title = a, window.history.replaceState({}, a, n), (popup = new Popup(800)).content = e, popup.show() } }) }, loadAsign = function (t) { var e = { nid: $(t).data("ref") }, a = Page.urlBase + "article.ashx?t=17"; $.ajax({ type: "POST", url: a, data: e, success: function (t) { isRealValue(popup) && popup.hide(), document.title = title, (popup = new Popup(800)).content = t, popup.show() } }) };